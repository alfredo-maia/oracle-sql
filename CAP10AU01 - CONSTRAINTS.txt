--CONSTRAINT 
--VERIFICANDO TODAS AS CONSTRAINTS

SELECT * FROM ALL_CONSTRAINTS; 

--VERIFICANDO AS CONTRAINTS DO USU√ÅRIO

SELECT * FROM USER_CONSTRAINTS;

--CRIANDO TABELA COM CONSTRAINT

CREATE TABLE TCIDADE(
  cod_cidade  INTEGER NOT NULL,
  nome VARCHAR(40),
  CONSTRAINT pk_cidade PRIMARY KEY (cod_cidade)
  );

--CRAINDO TABELA COM CONSTRAINTS COM DOIS CAMPOS SENDO CHAVE ESTRANGEIRAS

CREATE TABLE TBAIRRO (
  cod_cidade INTEGER NOT NULL,
  cod_bairro INTEGER NOT NULL,
  nome VARCHAR2(40),
  CONSTRAINT pk_bairro PRIMARY KEY(cod_cidade,cod_bairro)
);

--ADICONANDO CHAVE ESTRANGEIRA

ALTER TABLE TBAIRRO ADD CONSTRAINT fk_cod_cidade
FOREIGN KEY (COD_CIDADE)
REFERENCES TCIDADE(cod_cidade);

--CRIANDO TABELA TRUA

CREATE TABLE TRUA
(
  cod_rua INTEGER NOT NULL,
  cod_cidade INTEGER,
  cod_bairro INTEGER,
  nome VARCHAR2(40),
  CONSTRAINT pk_cod_rua PRIMARY KEY (cod_rua), --CHAVE PRIMARIA
  CONSTRAINT fk_cod_cidadebairro FOREIGN KEY (cod_cidade, cod_bairro) --CHAVE ESTRANGEIRA
  REFERENCES TBAIRRO(cod_cidade,cod_bairro)
);

--ADICONANDO CHAVE ESTRANGEIRA

ALTER TABLE TRUA ADD CONSTRAINT fk_cidadebairro FOREIGN KEY 
(cod_cidade,cod_bairro) REFERENCES TBAIRRO(cod_cidade,cod_bairro);

--CRIANDO TABELA TPESSOAS

CREATE TABLE TPESSOA
(
  cod_pessoa INTEGER  NOT NULL,
  tipo VARCHAR(1) NOT NULL,
  nome VARCHAR(40) NOT NULL,
  pessoa VARCHAR2 (1) NOT NULL,
  cod_rua INTEGER NOT NULL,
  cpf VARCHAR2(15),
  CONSTRAINT pk_pessoa PRIMARY KEY (cod_pessoa)
);

--ADICIONANDO UNIQUE KEY
ALTER TABLE TPESSOA ADD CONSTRAINT UK_CPF UNIQUE(CPF);

--ADICIONANDO CHAVE ESTRANGEIRA
ALTER TABLE TPESSOA ADD CONSTRAINT fk_pessoa_rua
FOREIGN KEY (COD_RUA)
REFERENCES TRUA;

--ADICIONANDO DADOS NA TABELA CIDADE
INSERT INTO TBAIRRO VALUES (1,'CENTRO');


SELECT * FROM USER_TABLES;

DROP TABLE TRUA;
