--FUNÇÕES DE AGRUPAMENTO
SELECT Count(*) AS QTDE_REGISTRO, --CONTADOR
       Round(Avg(TOTAL)) AS MEDIA, --MEDIA COM ARREDONDAMENTO
       Avg (TOTAL) AS MEDIA, --MEDIA 
       Max(TOTAL) AS MAXIMO, --MAXIMO CURSO MAIS CARO
       Min(TOTAL) AS MINIMO, --MINIMO CURSO MAIS BARATO
       Sum(TOTAL) AS SOMA, -- SOMA DE TODOS OS CURSOS
       Max(DATA) AS DATA_MAIOR, --DATA DA ULTIMA MAIS ATUAL
       Min(DATA) AS DATA_MENOR --DATA DA COMPRA MAIS ANTIGA
FROM TCONTRATO;
--NUMERO DE CONTRATOS POR ALUNO E VALOR TOTAL DOS CONTRATOS
SELECT Max(COD_CONTRATO) FROM TCONTRATO;

SELECT COD_ALUNO,
       Count(*) AS QTDE_CONTRATO,
       Sum(TOTAL) AS VALOR_TOTAL
FROM TCONTRATO
GROUP BY COD_ALUNO;
--AGRUPANDO POR DATA
SELECT To_Char(Trunc(DATA), 'DD/MM/YYYY') AS DATA,
       Sum(TOTAL) AS SOMA,
       Round(Avg(TOTAL),2) AS MEDIA,
       Count(*) AS QTE
FROM TCONTRATO
GROUP BY Trunc(DATA);

SELECT * FROM TCONTRATO;
