--SELECIONANDO DADOS COM LIGAÇÕES E LIKE PARA APRESENTAR ORDENAÇÃO
SELECT A.COD_ALUNO CÓDIGO, A.NOME AS ALUNO,
       C.COD_CONTRATO NÚMERO, C.DATA, C.TOTAL
FROM TALUNO A, TCONTRATO C
WHERE C.COD_CONTRATO = A.COD_ALUNO
AND UPPER(A.NOME) LIKE '%'
ORDER BY A.NOME;
--SELECIONANDO DADOS COM LIGAÇÕES
SELECT ALU.COD_ALUNO, ALU.NOME  ALUNO,
       CON.COD_CONTRATO, CON.DATA, CON.TOTAL,
       ITE.COD_CURSO, CUR.NOME  CURSO,
       ITE.VALOR
FROM TALUNO ALU, TCONTRATO  CON,
     TITEM ITE, TCURSO CUR
WHERE ALU.COD_ALUNO = CON.COD_ALUNO
AND CON.COD_CONTRATO = ITE.COD_CONTRATO
AND ITE.COD_CURSO = CUR.COD_CURSO
ORDER BY CON.TOTAL DESC;
--INSERINDO DADOS NA TABELA
INSERT INTO TALUNO (COD_ALUNO,NOME,CIDADE,CEP) VALUES (10,'PEDRO','NOVO HAMBURGO',NULL);
--MOSTRANDO DADOS COMPLETOS ATÉ SEM LIGAÇÕES
SELECT ALU.COD_ALUNO, ALU.NOME  ALUNO,
       CON.COD_CONTRATO, CON.DATA, CON.TOTAL,
       ITE.COD_CURSO, CUR.NOME  CURSO,
       ITE.VALOR
FROM TALUNO ALU, TCONTRATO  CON,
     TITEM ITE, TCURSO CUR
WHERE ALU.COD_ALUNO = CON.COD_ALUNO (+)
AND CON.COD_CONTRATO = ITE.COD_CONTRATO(+)
AND ITE.COD_CURSO = CUR.COD_CURSO(+)
ORDER BY ALU.COD_ALUNO;
--SELECIONANDO TUDO
SELECT * FROM TALUNO;
--COMITANDO
COMMIT;
--CRIANDO TABELA
CREATE TABLE TDESCONTO
    (CLASSE VARCHAR (1) PRIMARY KEY,
     INFERIOR NUMBER (4,2),
     SUPERIOR NUMBER (4,2)
     );
--SELECIONANDO DADOS
SELECT * FROM TDESCONTO;
--INSERINDO DADOS NA TABELA NOVA
INSERT INTO TDESCONTO VALUES ('A',0,10);
INSERT INTO TDESCONTO VALUES ('B',11,15);
INSERT INTO TDESCONTO VALUES ('C',16,20);
INSERT INTO TDESCONTO VALUES ('D',21,25);
INSERT INTO TDESCONTO VALUES ('E',26,30);

DELETE FROM TDESCONTO;

SELECT * FROM TCONTRATO;

UPDATE TCONTRATO SET DESCONTO = 27 WHERE COD_CONTRATO = 5;

UPDATE TCONTRATO SET DESCONTO = 18 WHERE COD_CONTRATO = 6;

COMMIT;

SELECT CON.COD_CONTRATO AS CONTRATO,
       DES.CLASSE AS DESCONTO
FROM TCONTRATO CON, TDESCONTO DES
WHERE CON.DESCONTO BETWEEN DES.INFERIOR AND DES.SUPERIOR
ORDER BY CON.COD_CONTRATO;
--CURSOS VENDIDOS
SELECT CUR.COD_CURSO, CUR.NOME,ITE.VALOR
FROM TCURSO CUR, TITEM ITE
WHERE CUR.COD_CURSO = ITE.COD_CURSO;
--CURSOS NÃO VENDIDOS
SELECT CUR.COD_CURSO, CUR.NOME, ITE.VALOR
FROM TCURSO CUR, TITEM ITE
WHERE CUR.COD_CURSO = ITE.COD_CURSO(+)
AND ITE.COD_ITEM IS NULL;
--INSERINDO MAIS CURSO
INSERT INTO TCURSO VALUES (6,'PHP',1000,1OO,NULL);
INSERT INTO TCURSO VALUES (7,'LOGICA',100,20,NULL);
INSERT INTO TCURSO VALUES (6,'PHP',100,1OO,NULL);
--COMITANDO
COMMIT;

SELECT * FROM TCURSO WHERE COD_CURSO = 6;

SELECT * FROM TCURSO;
--SELECIONANDO O NOME E O PRE-REQUISITO  (MINHA CRIAÇÃO)
SELECT T1.NOME CURSO,T2.NOME PRE_REQUESITO
FROM TCURSO T1, TCURSO T2
WHERE T2.COD_CURSO = T1.PRE_REQ 
AND T1.PRE_REQ IS NOT NULL;
--sELECIONANDO O NOME E O PRE-REQUISITO (TEACHER)
SELECT CURSO.NOME AS CURSO, 
       PRE_REQ.NOME AS PRE_REQUISITO
FROM TCURSO CURSO, TCURSO PRE_REQ
WHERE CURSO.PRE_REQ = PRE_REQ.COD_CURSO;