--MEDIA COM NVL
SELECT Sum(DESCONTO) SOMA,
       Avg(DESCONTO) "MEDIA ERRADA",
       Count(DESCONTO) "QTD DE DESCONTO",
       Round(Avg(Nvl(DESCONTO,0)),2) "MEDIA CORRETA"
FROM TCONTRATO;
--TOTAL DE DESCONTO POR ESTADO
SELECT ALU.ESTADO,
       Sum(CON.TOTAL),TOTAL, Count(*) QTD
FROM TALUNO ALU, TCONTRATO CON
WHERE ALU.COD_ALUNO = CON.COD_ALUNO
GROUP BY ALU.ESTADO                     
ORDER BY ALU.ESTADO; 
--FILTRA ALUNOS COM A FUNÇÃO DE GRUPO
SELECT COD_ALUNO, Round(Avg(TOTAL),2) MEDIA
FROM TCONTRATO
WHERE COD_ALUNO > 0
HAVING Round(Avg(TOTAL),2) > 500
GROUP BY COD_ALUNO;
--MAIOR MEDIA POR ALUNO
SELECT Max(Avg(TOTAL))
FROM TCONTRATO
GROUP BY COD_CONTRATO;
--SOMA DOS SALARIOS POR ESTADO
SELECT ESTADO,Sum(SALARIO) AS TOTAL
FROM TALUNO
GROUP BY ESTADO
ORDER BY TOTAL DESC;
--MAIOR MEDIA POR ALUNO
SELECT Max(Avg(CON.TOTAL)), CON.COD_CONTRATO
FROM  TCONTRATO CON, TALUNO ALU
WHERE CON.COD_ALUNO = ALU.COD_ALUNO
GROUP BY CON.COD_CONTRATO;